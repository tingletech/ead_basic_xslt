<!DOCTYPE html>  <html> <head>   <title>table.html.xsl</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               table.html.xsl             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="cp">&lt;?xml version=&#39;1.0&#39;?&gt;</span>
<span class="k">&lt;xsl:stylesheet</span> <span class="na">xmlns:xsl=</span><span class="s">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span>
                <span class="na">xmlns:doc=</span><span class="s">&quot;http://nwalsh.com/xsl/documentation/1.0&quot;</span>
                <span class="na">xmlns:stbl=</span><span class="s">&quot;http://nwalsh.com/xslt/ext/com.nwalsh.saxon.Table&quot;</span>
                <span class="na">xmlns:xtbl=</span><span class="s">&quot;com.nwalsh.xalan.Table&quot;</span>
                <span class="na">xmlns:lxslt=</span><span class="s">&quot;http://xml.apache.org/xslt&quot;</span>
                <span class="na">xmlns:ptbl=</span><span class="s">&quot;http://nwalsh.com/xslt/ext/xsltproc/python/Table&quot;</span>
                <span class="na">exclude-result-prefixes=</span><span class="s">&quot;doc stbl xtbl lxslt ptbl&quot;</span>
                <span class="na">version=</span><span class="s">&#39;1.0&#39;</span><span class="nt">&gt;</span>

<span class="k">&lt;xsl:include</span> <span class="na">href=</span><span class="s">&quot;table.common.xsl&quot;</span><span class="nt">/&gt;</span>

<span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;default.table.width&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;&#39;&quot;</span><span class="nt">&gt;</span><span class="k">&lt;/xsl:param&gt;</span>
<span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;nominal.table.width&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;6in&#39;&quot;</span><span class="nt">&gt;</span><span class="k">&lt;/xsl:param&gt;</span>
<span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;table.borders.with.css&quot;</span> <span class="na">select=</span><span class="s">&quot;0&quot;</span><span class="nt">&gt;</span><span class="k">&lt;/xsl:param&gt;</span>
<span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;table.cell.border.style&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;solid&#39;&quot;</span><span class="nt">&gt;</span><span class="k">&lt;/xsl:param&gt;</span>
<span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;table.cell.border.thickness&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;0.5pt&#39;&quot;</span><span class="nt">&gt;</span><span class="k">&lt;/xsl:param&gt;</span>
<span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;table.cell.border.color&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;&#39;&quot;</span><span class="nt">&gt;</span><span class="k">&lt;/xsl:param&gt;</span>
<span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;table.frame.border.style&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;solid&#39;&quot;</span><span class="nt">&gt;</span><span class="k">&lt;/xsl:param&gt;</span>
<span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;table.frame.border.thickness&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;0.5pt&#39;&quot;</span><span class="nt">&gt;</span><span class="k">&lt;/xsl:param&gt;</span>
<span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;table.frame.border.color&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;&#39;&quot;</span><span class="nt">&gt;</span><span class="k">&lt;/xsl:param&gt;</span>
<span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;html.cellspacing&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;&#39;&quot;</span><span class="nt">&gt;</span><span class="k">&lt;/xsl:param&gt;</span>
<span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;html.cellpadding&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;&#39;&quot;</span><span class="nt">&gt;</span><span class="k">&lt;/xsl:param&gt;</span>

<span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;use.extensions&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;0&#39;&quot;</span><span class="nt">&gt;</span><span class="k">&lt;/xsl:param&gt;</span>
<span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;entry.propagates.style&quot;</span> <span class="na">select=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span><span class="k">&lt;/xsl:param&gt;</span>
<span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;show.revisionflag&quot;</span><span class="nt">&gt;</span>0<span class="k">&lt;/xsl:param&gt;</span>

<span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;tablecolumns.extension&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;0&#39;&quot;</span><span class="nt">&gt;</span><span class="k">&lt;/xsl:param&gt;</span>

<span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;stylesheet.result.type&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;html&#39;&quot;</span><span class="nt">/&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>Copyright</p>

<p>Copyright (C) 1999, 2000, 2001, 2002 Norman Walsh</p>

<p>Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the ``Software''), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or
sell copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:</p>

<p>The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.</p>

<p>Except as contained in this notice, the names of individuals
credited with contribution to this software shall not be used in
advertising or otherwise to promote the sale, use or other
dealings in this Software without prior written authorization
from the individuals in question.</p>

<p>Any stylesheet derived from this Software that is publically
distributed will be identified with a different name and the
version strings in any derived Software will be changed so that
no possibility of confusion between the derived package and this
Software will exist.</p>

<hr />

<pre><code>derived from  $Id: table.html.xsl,v 1.1 2008/09/13 17:15:12 tingle Exp $
</code></pre>

<hr />

<pre><code> This file is part of the XSL DocBook Stylesheet distribution.
 See ../README or http://nwalsh.com/docbook/xsl/ for copyright
 and other information.

 ******************************************************************** 
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre><span class="nt">&lt;lxslt:component</span> <span class="na">prefix=</span><span class="s">&quot;xtbl&quot;</span>
                 <span class="na">functions=</span><span class="s">&quot;adjustColumnWidths&quot;</span><span class="nt">/&gt;</span>

<span class="k">&lt;xsl:template</span> <span class="na">name=</span><span class="s">&quot;empty.table.cell&quot;</span><span class="nt">&gt;</span>
  <span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;colnum&quot;</span> <span class="na">select=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>

  <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;rowsep&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
      </pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>If this is the last row, rowsep never applies. </p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;not(ancestor-or-self::row[1]/following-sibling::row</span>
<span class="s">                          or ancestor-or-self::thead/following-sibling::tbody</span>
<span class="s">                          or ancestor-or-self::tbody/preceding-sibling::tfoot)&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:when&gt;</span>
      <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;inherited.table.attribute&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;entry&quot;</span> <span class="na">select=</span><span class="s">&quot;NOT-AN-ELEMENT-NAME&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;row&quot;</span> <span class="na">select=</span><span class="s">&quot;ancestor-or-self::row[1]&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;colnum&quot;</span> <span class="na">select=</span><span class="s">&quot;$colnum&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;attribute&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;rowsep&#39;&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;/xsl:call-template&gt;</span>
      <span class="k">&lt;/xsl:otherwise&gt;</span>
    <span class="k">&lt;/xsl:choose&gt;</span>
  <span class="k">&lt;/xsl:variable&gt;</span>

  <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;colsep&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
      </pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>If this is the last column, colsep never applies. </p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;$colnum &amp;gt;= ancestor::tgroup/@cols&quot;</span><span class="nt">&gt;</span>0<span class="k">&lt;/xsl:when&gt;</span>
      <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;inherited.table.attribute&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;entry&quot;</span> <span class="na">select=</span><span class="s">&quot;NOT-AN-ELEMENT-NAME&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;row&quot;</span> <span class="na">select=</span><span class="s">&quot;ancestor-or-self::row[1]&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;colnum&quot;</span> <span class="na">select=</span><span class="s">&quot;$colnum&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;attribute&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;colsep&#39;&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;/xsl:call-template&gt;</span>
      <span class="k">&lt;/xsl:otherwise&gt;</span>
    <span class="k">&lt;/xsl:choose&gt;</span>
  <span class="k">&lt;/xsl:variable&gt;</span>

  <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">&quot;auto-generated&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$table.borders.with.css != 0&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;style&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$colsep &amp;gt; 0&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;border&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;side&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;right&#39;&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:call-template&gt;</span>
        <span class="k">&lt;/xsl:if&gt;</span>
        <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$rowsep &amp;gt; 0&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;border&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;side&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;bottom&#39;&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:call-template&gt;</span>
        <span class="k">&lt;/xsl:if&gt;</span>
      <span class="k">&lt;/xsl:attribute&gt;</span>
    <span class="k">&lt;/xsl:if&gt;</span>
    <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span><span class="ni">&amp;#160;</span><span class="k">&lt;/xsl:text&gt;</span>
  <span class="nt">&lt;/td&gt;</span>
<span class="k">&lt;/xsl:template&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>==================================================================== </p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">&lt;xsl:template</span> <span class="na">name=</span><span class="s">&quot;border&quot;</span><span class="nt">&gt;</span>
  <span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;side&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;left&#39;&quot;</span><span class="nt">/&gt;</span>
  <span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;padding&quot;</span> <span class="na">select=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
  <span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;style&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.cell.border.style&quot;</span><span class="nt">/&gt;</span>
  <span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;color&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.cell.border.color&quot;</span><span class="nt">/&gt;</span>
  <span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;thickness&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.cell.border.thickness&quot;</span><span class="nt">/&gt;</span>

  </pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Note: Some browsers (mozilla) require at least a width and style. </p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;($thickness != &#39;&#39;</span>
<span class="s">                     and $style != &#39;&#39;</span>
<span class="s">                     and $color != &#39;&#39;)</span>
<span class="s">                    or ($thickness != &#39;&#39;</span>
<span class="s">                        and $style != &#39;&#39;)</span>
<span class="s">                    or ($thickness != &#39;&#39;)&quot;</span><span class="nt">&gt;</span>
      </pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>use the compound property if we can: </p>             </td>             <td class="code">               <div class="highlight"><pre>      </pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>it saves space and probably works more reliably </p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span>border-<span class="k">&lt;/xsl:text&gt;</span>
      <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$side&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span>: <span class="k">&lt;/xsl:text&gt;</span>
      <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$thickness&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span> <span class="k">&lt;/xsl:text&gt;</span>
      <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$style&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span> <span class="k">&lt;/xsl:text&gt;</span>
      <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$color&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span>; <span class="k">&lt;/xsl:text&gt;</span>
    <span class="k">&lt;/xsl:when&gt;</span>
    <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
      </pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>we need to specify the styles individually </p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$thickness != &#39;&#39;&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span>border-<span class="k">&lt;/xsl:text&gt;</span>
        <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$side&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span>-width: <span class="k">&lt;/xsl:text&gt;</span>
        <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$thickness&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span>; <span class="k">&lt;/xsl:text&gt;</span>
      <span class="k">&lt;/xsl:if&gt;</span>

      <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$style != &#39;&#39;&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span>border-<span class="k">&lt;/xsl:text&gt;</span>
        <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$side&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span>-style: <span class="k">&lt;/xsl:text&gt;</span>
        <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$style&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span>; <span class="k">&lt;/xsl:text&gt;</span>
      <span class="k">&lt;/xsl:if&gt;</span>

      <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$color != &#39;&#39;&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span>border-<span class="k">&lt;/xsl:text&gt;</span>
        <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$side&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span>-color: <span class="k">&lt;/xsl:text&gt;</span>
        <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$color&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span>; <span class="k">&lt;/xsl:text&gt;</span>
      <span class="k">&lt;/xsl:if&gt;</span>
    <span class="k">&lt;/xsl:otherwise&gt;</span>
  <span class="k">&lt;/xsl:choose&gt;</span>
<span class="k">&lt;/xsl:template&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>==================================================================== </p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;tgroup&quot;</span> <span class="na">name=</span><span class="s">&quot;tgroup&quot;</span> <span class="na">mode=</span><span class="s">&quot;ead&quot;</span><span class="nt">&gt;</span>
  <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;not(@cols)&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:message</span> <span class="na">terminate=</span><span class="s">&quot;yes&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span>Error: CALS tables must specify the number of columns.<span class="k">&lt;/xsl:text&gt;</span>
    <span class="k">&lt;/xsl:message&gt;</span>
  <span class="k">&lt;/xsl:if&gt;</span>

  <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;summary&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;dbhtml-attribute&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;pis&quot;</span>
                      <span class="na">select=</span><span class="s">&quot;processing-instruction(&#39;dbhtml&#39;)&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;attribute&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;table-summary&#39;&quot;</span><span class="nt">/&gt;</span>
    <span class="k">&lt;/xsl:call-template&gt;</span>
  <span class="k">&lt;/xsl:variable&gt;</span>

  <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;cellspacing&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;dbhtml-attribute&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;pis&quot;</span>
                      <span class="na">select=</span><span class="s">&quot;processing-instruction(&#39;dbhtml&#39;)&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;attribute&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;cellspacing&#39;&quot;</span><span class="nt">/&gt;</span>
    <span class="k">&lt;/xsl:call-template&gt;</span>
  <span class="k">&lt;/xsl:variable&gt;</span>

  <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;cellpadding&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;dbhtml-attribute&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;pis&quot;</span>
                      <span class="na">select=</span><span class="s">&quot;processing-instruction(&#39;dbhtml&#39;)[1]&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;attribute&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;cellpadding&#39;&quot;</span><span class="nt">/&gt;</span>
    <span class="k">&lt;/xsl:call-template&gt;</span>
  <span class="k">&lt;/xsl:variable&gt;</span>

  <span class="nt">&lt;table&gt;</span>
    <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
      </pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>If there's a textobject/phrase for the table summary, use it </p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;../textobject/phrase&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;summary&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;../textobject/phrase&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;/xsl:attribute&gt;</span>
      <span class="k">&lt;/xsl:when&gt;</span>

      </pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>If there's a <?dbhtml table-summary="foo"?> PI, use it for
           the HTML table summary attribute </p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;$summary != &#39;&#39;&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;summary&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$summary&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;/xsl:attribute&gt;</span>
      <span class="k">&lt;/xsl:when&gt;</span>

      </pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>Otherwise, if there's a title, use that </p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;../title&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;summary&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;string(../title)&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;/xsl:attribute&gt;</span>
      <span class="k">&lt;/xsl:when&gt;</span>

      </pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>Otherwise, forget the whole idea </p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>nevermind </p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">&lt;/xsl:choose&gt;</span>

    <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$cellspacing != &#39;&#39; or $html.cellspacing != &#39;&#39;&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;cellspacing&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;$cellspacing != &#39;&#39;&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$cellspacing&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:when&gt;</span>
          <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$html.cellspacing&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:otherwise&gt;</span>
        <span class="k">&lt;/xsl:choose&gt;</span>
      <span class="k">&lt;/xsl:attribute&gt;</span>
    <span class="k">&lt;/xsl:if&gt;</span>

    <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$cellpadding != &#39;&#39; or $html.cellpadding != &#39;&#39;&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;cellpadding&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;$cellpadding != &#39;&#39;&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$cellpadding&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:when&gt;</span>
          <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$html.cellpadding&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:otherwise&gt;</span>
        <span class="k">&lt;/xsl:choose&gt;</span>
      <span class="k">&lt;/xsl:attribute&gt;</span>
    <span class="k">&lt;/xsl:if&gt;</span>

    <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;../@pgwide=1 or local-name(.) = &#39;entrytbl&#39;&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;width&quot;</span><span class="nt">&gt;</span>100%<span class="k">&lt;/xsl:attribute&gt;</span>
    <span class="k">&lt;/xsl:if&gt;</span>

    <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;$table.borders.with.css != 0&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;border&quot;</span><span class="nt">&gt;</span>0<span class="k">&lt;/xsl:attribute&gt;</span>
        <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;../@frame=&#39;all&#39;&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;style&quot;</span><span class="nt">&gt;</span>
              <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span>border-collapse: collapse;<span class="k">&lt;/xsl:text&gt;</span>
              <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;border&quot;</span><span class="nt">&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;side&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;top&#39;&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;style&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.style&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;color&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.color&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;thickness&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.thickness&quot;</span><span class="nt">/&gt;</span>
              <span class="k">&lt;/xsl:call-template&gt;</span>
              <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;border&quot;</span><span class="nt">&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;side&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;bottom&#39;&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;style&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.style&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;color&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.color&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;thickness&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.thickness&quot;</span><span class="nt">/&gt;</span>
              <span class="k">&lt;/xsl:call-template&gt;</span>
              <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;border&quot;</span><span class="nt">&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;side&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;left&#39;&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;style&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.style&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;color&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.color&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;thickness&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.thickness&quot;</span><span class="nt">/&gt;</span>
              <span class="k">&lt;/xsl:call-template&gt;</span>
              <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;border&quot;</span><span class="nt">&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;side&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;right&#39;&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;style&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.style&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;color&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.color&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;thickness&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.thickness&quot;</span><span class="nt">/&gt;</span>
              <span class="k">&lt;/xsl:call-template&gt;</span>
            <span class="k">&lt;/xsl:attribute&gt;</span>
          <span class="k">&lt;/xsl:when&gt;</span>
          <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;../@frame=&#39;topbot&#39;&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;style&quot;</span><span class="nt">&gt;</span>
              <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span>border-collapse: collapse;<span class="k">&lt;/xsl:text&gt;</span>
              <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;border&quot;</span><span class="nt">&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;side&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;top&#39;&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;style&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.style&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;color&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.color&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;thickness&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.thickness&quot;</span><span class="nt">/&gt;</span>
              <span class="k">&lt;/xsl:call-template&gt;</span>
              <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;border&quot;</span><span class="nt">&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;side&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;bottom&#39;&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;style&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.style&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;color&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.color&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;thickness&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.thickness&quot;</span><span class="nt">/&gt;</span>
              <span class="k">&lt;/xsl:call-template&gt;</span>
            <span class="k">&lt;/xsl:attribute&gt;</span>
          <span class="k">&lt;/xsl:when&gt;</span>
          <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;../@frame=&#39;top&#39;&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;style&quot;</span><span class="nt">&gt;</span>
              <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span>border-collapse: collapse;<span class="k">&lt;/xsl:text&gt;</span>
              <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;border&quot;</span><span class="nt">&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;side&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;top&#39;&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;style&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.style&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;color&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.color&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;thickness&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.thickness&quot;</span><span class="nt">/&gt;</span>
              <span class="k">&lt;/xsl:call-template&gt;</span>
            <span class="k">&lt;/xsl:attribute&gt;</span>
          <span class="k">&lt;/xsl:when&gt;</span>
          <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;../@frame=&#39;bottom&#39;&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;style&quot;</span><span class="nt">&gt;</span>
              <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span>border-collapse: collapse;<span class="k">&lt;/xsl:text&gt;</span>
              <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;border&quot;</span><span class="nt">&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;side&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;bottom&#39;&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;style&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.style&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;color&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.color&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;thickness&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.thickness&quot;</span><span class="nt">/&gt;</span>
              <span class="k">&lt;/xsl:call-template&gt;</span>
            <span class="k">&lt;/xsl:attribute&gt;</span>
          <span class="k">&lt;/xsl:when&gt;</span>
          <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;../@frame=&#39;sides&#39;&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;style&quot;</span><span class="nt">&gt;</span>
              <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span>border-collapse: collapse;<span class="k">&lt;/xsl:text&gt;</span>
              <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;border&quot;</span><span class="nt">&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;side&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;left&#39;&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;style&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.style&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;color&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.color&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;thickness&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.thickness&quot;</span><span class="nt">/&gt;</span>
              <span class="k">&lt;/xsl:call-template&gt;</span>
              <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;border&quot;</span><span class="nt">&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;side&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;right&#39;&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;style&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.style&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;color&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.color&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;thickness&quot;</span> <span class="na">select=</span><span class="s">&quot;$table.frame.border.thickness&quot;</span><span class="nt">/&gt;</span>
              <span class="k">&lt;/xsl:call-template&gt;</span>
            <span class="k">&lt;/xsl:attribute&gt;</span>
          <span class="k">&lt;/xsl:when&gt;</span>
          <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;style&quot;</span><span class="nt">&gt;</span>
              <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span>border-collapse: collapse;<span class="k">&lt;/xsl:text&gt;</span>
            <span class="k">&lt;/xsl:attribute&gt;</span>
          <span class="k">&lt;/xsl:otherwise&gt;</span>
        <span class="k">&lt;/xsl:choose&gt;</span>
      <span class="k">&lt;/xsl:when&gt;</span>
      <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;../@frame=&#39;none&#39; or local-name(.) = &#39;entrytbl&#39;&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;border&quot;</span><span class="nt">&gt;</span>0<span class="k">&lt;/xsl:attribute&gt;</span>
      <span class="k">&lt;/xsl:when&gt;</span>
      <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;border&quot;</span><span class="nt">&gt;</span>1<span class="k">&lt;/xsl:attribute&gt;</span>
      <span class="k">&lt;/xsl:otherwise&gt;</span>
    <span class="k">&lt;/xsl:choose&gt;</span>

    <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;colgroup&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;colgroup&gt;</span>
        <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;generate.colgroup&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;cols&quot;</span> <span class="na">select=</span><span class="s">&quot;@cols&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;/xsl:call-template&gt;</span>
      <span class="nt">&lt;/colgroup&gt;</span>
    <span class="k">&lt;/xsl:variable&gt;</span>

    <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;explicit.table.width&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;dbhtml-attribute&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;pis&quot;</span>
                        <span class="na">select=</span><span class="s">&quot;../processing-instruction(&#39;dbhtml&#39;)[1]&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;attribute&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;table-width&#39;&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:call-template&gt;</span>
    <span class="k">&lt;/xsl:variable&gt;</span>

    <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;table.width&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;$explicit.table.width != &#39;&#39;&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$explicit.table.width&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;/xsl:when&gt;</span>
        <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;$default.table.width = &#39;&#39;&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span>100%<span class="k">&lt;/xsl:text&gt;</span>
        <span class="k">&lt;/xsl:when&gt;</span>
        <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$default.table.width&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;/xsl:otherwise&gt;</span>
      <span class="k">&lt;/xsl:choose&gt;</span>
    <span class="k">&lt;/xsl:variable&gt;</span>

    <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$default.table.width != &#39;&#39;</span>
<span class="s">                  or $explicit.table.width != &#39;&#39;&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;width&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;contains($table.width, &#39;%&#39;)&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$table.width&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:when&gt;</span>
          <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;$use.extensions != 0</span>
<span class="s">                          and $tablecolumns.extension != 0&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
              <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;function-available(&#39;stbl:convertLength&#39;)&quot;</span><span class="nt">&gt;</span>
                <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;stbl:convertLength($table.width)&quot;</span><span class="nt">/&gt;</span>
              <span class="k">&lt;/xsl:when&gt;</span>
              <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;function-available(&#39;xtbl:convertLength&#39;)&quot;</span><span class="nt">&gt;</span>
                <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;xtbl:convertLength($table.width)&quot;</span><span class="nt">/&gt;</span>
              <span class="k">&lt;/xsl:when&gt;</span>
              <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
                <span class="k">&lt;xsl:message</span> <span class="na">terminate=</span><span class="s">&quot;yes&quot;</span><span class="nt">&gt;</span>
                  <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span>No convertLength function available.<span class="k">&lt;/xsl:text&gt;</span>
                <span class="k">&lt;/xsl:message&gt;</span>
              <span class="k">&lt;/xsl:otherwise&gt;</span>
            <span class="k">&lt;/xsl:choose&gt;</span>
          <span class="k">&lt;/xsl:when&gt;</span>
          <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$table.width&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:otherwise&gt;</span>
        <span class="k">&lt;/xsl:choose&gt;</span>
      <span class="k">&lt;/xsl:attribute&gt;</span>
    <span class="k">&lt;/xsl:if&gt;</span>

    <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;$use.extensions != 0</span>
<span class="s">                      and $tablecolumns.extension != 0&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;function-available(&#39;stbl:adjustColumnWidths&#39;)&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:copy-of</span> <span class="na">select=</span><span class="s">&quot;stbl:adjustColumnWidths($colgroup)&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:when&gt;</span>
          <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;function-available(&#39;xtbl:adjustColumnWidths&#39;)&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:copy-of</span> <span class="na">select=</span><span class="s">&quot;xtbl:adjustColumnWidths($colgroup)&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:when&gt;</span>
          <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;function-available(&#39;ptbl:adjustColumnWidths&#39;)&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:copy-of</span> <span class="na">select=</span><span class="s">&quot;ptbl:adjustColumnWidths($colgroup)&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:when&gt;</span>
          <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:message</span> <span class="na">terminate=</span><span class="s">&quot;yes&quot;</span><span class="nt">&gt;</span>
              <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span>No adjustColumnWidths function available.<span class="k">&lt;/xsl:text&gt;</span>
            <span class="k">&lt;/xsl:message&gt;</span>
          <span class="k">&lt;/xsl:otherwise&gt;</span>
        <span class="k">&lt;/xsl:choose&gt;</span>
      <span class="k">&lt;/xsl:when&gt;</span>
      <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:copy-of</span> <span class="na">select=</span><span class="s">&quot;$colgroup&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:otherwise&gt;</span>
    <span class="k">&lt;/xsl:choose&gt;</span>

    <span class="k">&lt;xsl:apply-templates</span> <span class="na">select=</span><span class="s">&quot;thead&quot;</span> <span class="na">mode=</span><span class="s">&quot;ead&quot;</span><span class="nt">/&gt;</span>
    <span class="k">&lt;xsl:apply-templates</span> <span class="na">select=</span><span class="s">&quot;tfoot&quot;</span> <span class="na">mode=</span><span class="s">&quot;ead&quot;</span><span class="nt">/&gt;</span>
    <span class="k">&lt;xsl:apply-templates</span> <span class="na">select=</span><span class="s">&quot;tbody&quot;</span> <span class="na">mode=</span><span class="s">&quot;ead&quot;</span><span class="nt">/&gt;</span>

    <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;.//footnote&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;tbody</span> <span class="na">class=</span><span class="s">&quot;footnotes&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;tr&gt;</span>
          <span class="nt">&lt;td</span> <span class="na">colspan=</span><span class="s">&quot;{@cols}&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:apply-templates</span> <span class="na">select=</span><span class="s">&quot;.//footnote&quot;</span> <span class="na">mode=</span><span class="s">&quot;table.footnote.mode&quot;</span><span class="nt">/&gt;</span>
          <span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
      <span class="nt">&lt;/tbody&gt;</span>
    <span class="k">&lt;/xsl:if&gt;</span>
  <span class="nt">&lt;/table&gt;</span>
<span class="k">&lt;/xsl:template&gt;</span>

<span class="k">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;tgroup/processing-instruction(&#39;dbhtml&#39;)&quot;</span> <span class="na">mode=</span><span class="s">&quot;ead&quot;</span><span class="nt">&gt;</span>
  <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;summary&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;dbhtml-attribute&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;pis&quot;</span> <span class="na">select=</span><span class="s">&quot;.&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;attribute&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;table-summary&#39;&quot;</span><span class="nt">/&gt;</span>
    <span class="k">&lt;/xsl:call-template&gt;</span>
  <span class="k">&lt;/xsl:variable&gt;</span>

  </pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Suppress the table-summary PI </p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$summary = &#39;&#39;&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:processing-instruction</span> <span class="na">name=</span><span class="s">&quot;dbhtml&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;.&quot;</span><span class="nt">/&gt;</span>
    <span class="k">&lt;/xsl:processing-instruction&gt;</span>
  <span class="k">&lt;/xsl:if&gt;</span>
<span class="k">&lt;/xsl:template&gt;</span>

<span class="k">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;colspec&quot;</span> <span class="na">mode=</span><span class="s">&quot;ead&quot;</span><span class="nt">&gt;</span><span class="k">&lt;/xsl:template&gt;</span>

<span class="k">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;spanspec&quot;</span> <span class="na">mode=</span><span class="s">&quot;ead&quot;</span><span class="nt">&gt;</span><span class="k">&lt;/xsl:template&gt;</span>

<span class="k">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;thead|tfoot&quot;</span> <span class="na">mode=</span><span class="s">&quot;ead&quot;</span><span class="nt">&gt;</span>
  <span class="k">&lt;xsl:element</span> <span class="na">name=</span><span class="s">&quot;{name(.)}&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;@align&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;align&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;@align&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:attribute&gt;</span>
    <span class="k">&lt;/xsl:if&gt;</span>
    <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;@char&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;char&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;@char&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:attribute&gt;</span>
    <span class="k">&lt;/xsl:if&gt;</span>
    <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;@charoff&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;charoff&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;@charoff&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:attribute&gt;</span>
    <span class="k">&lt;/xsl:if&gt;</span>
    <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;@valign&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;valign&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;@valign&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:attribute&gt;</span>
    <span class="k">&lt;/xsl:if&gt;</span>

    <span class="k">&lt;xsl:apply-templates</span> <span class="na">select=</span><span class="s">&quot;row[1]&quot;</span> <span class="na">mode=</span><span class="s">&quot;ead&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;spans&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;blank.spans&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;cols&quot;</span> <span class="na">select=</span><span class="s">&quot;../@cols&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;/xsl:call-template&gt;</span>
      <span class="k">&lt;/xsl:with-param&gt;</span>
    <span class="k">&lt;/xsl:apply-templates&gt;</span>

  <span class="k">&lt;/xsl:element&gt;</span>
<span class="k">&lt;/xsl:template&gt;</span>

<span class="k">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;tbody&quot;</span> <span class="na">mode=</span><span class="s">&quot;ead&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;tbody&gt;</span>
    <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;@align&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;align&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;@align&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:attribute&gt;</span>
    <span class="k">&lt;/xsl:if&gt;</span>
    <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;@char&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;char&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;@char&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:attribute&gt;</span>
    <span class="k">&lt;/xsl:if&gt;</span>
    <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;@charoff&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;charoff&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;@charoff&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:attribute&gt;</span>
    <span class="k">&lt;/xsl:if&gt;</span>
    <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;@valign&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;valign&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;@valign&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:attribute&gt;</span>
    <span class="k">&lt;/xsl:if&gt;</span>

    <span class="k">&lt;xsl:apply-templates</span> <span class="na">select=</span><span class="s">&quot;row[1]&quot;</span> <span class="na">mode=</span><span class="s">&quot;ead&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;spans&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;blank.spans&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;cols&quot;</span> <span class="na">select=</span><span class="s">&quot;../@cols&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;/xsl:call-template&gt;</span>
      <span class="k">&lt;/xsl:with-param&gt;</span>
    <span class="k">&lt;/xsl:apply-templates&gt;</span>

  <span class="nt">&lt;/tbody&gt;</span>
<span class="k">&lt;/xsl:template&gt;</span>

<span class="k">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;row&quot;</span> <span class="na">mode=</span><span class="s">&quot;ead&quot;</span><span class="nt">&gt;</span>
  <span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;spans&quot;</span><span class="nt">/&gt;</span>

  <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;row-height&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;processing-instruction(&#39;dbhtml&#39;)&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;dbhtml-attribute&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;pis&quot;</span> <span class="na">select=</span><span class="s">&quot;processing-instruction(&#39;dbhtml&#39;)&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;attribute&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;row-height&#39;&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:call-template&gt;</span>
    <span class="k">&lt;/xsl:if&gt;</span>
  <span class="k">&lt;/xsl:variable&gt;</span>

  <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;bgcolor&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;processing-instruction(&#39;dbhtml&#39;)&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;dbhtml-attribute&quot;</span><span class="nt">&gt;</span>
  <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;pis&quot;</span> <span class="na">select=</span><span class="s">&quot;processing-instruction(&#39;dbhtml&#39;)&quot;</span><span class="nt">/&gt;</span>
  <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;attribute&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;bgcolor&#39;&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:call-template&gt;</span>
    <span class="k">&lt;/xsl:if&gt;</span>
  <span class="k">&lt;/xsl:variable&gt;</span>

  <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;class&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;processing-instruction(&#39;dbhtml&#39;)&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;dbhtml-attribute&quot;</span><span class="nt">&gt;</span>
  <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;pis&quot;</span> <span class="na">select=</span><span class="s">&quot;processing-instruction(&#39;dbhtml&#39;)&quot;</span><span class="nt">/&gt;</span>
  <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;attribute&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;class&#39;&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:call-template&gt;</span>
    <span class="k">&lt;/xsl:if&gt;</span>
  <span class="k">&lt;/xsl:variable&gt;</span>

  <span class="nt">&lt;tr&gt;</span>
    <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;tr.attributes&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;rownum&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:number</span> <span class="na">from=</span><span class="s">&quot;tgroup&quot;</span> <span class="na">count=</span><span class="s">&quot;row&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:with-param&gt;</span>
    <span class="k">&lt;/xsl:call-template&gt;</span>

    <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$row-height != &#39;&#39;&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;height&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$row-height&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:attribute&gt;</span>
    <span class="k">&lt;/xsl:if&gt;</span>

    <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$bgcolor != &#39;&#39;&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;bgcolor&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$bgcolor&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:attribute&gt;</span>
    <span class="k">&lt;/xsl:if&gt;</span>

    <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$class != &#39;&#39;&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;class&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$class&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:attribute&gt;</span>
    <span class="k">&lt;/xsl:if&gt;</span>

    <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$table.borders.with.css != 0&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;@rowsep = 1 and following-sibling::row&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;style&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;border&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;side&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;bottom&#39;&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:call-template&gt;</span>
        <span class="k">&lt;/xsl:attribute&gt;</span>
      <span class="k">&lt;/xsl:if&gt;</span>
    <span class="k">&lt;/xsl:if&gt;</span>

    <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;@align&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;align&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;@align&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:attribute&gt;</span>
    <span class="k">&lt;/xsl:if&gt;</span>
    <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;@char&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;char&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;@char&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:attribute&gt;</span>
    <span class="k">&lt;/xsl:if&gt;</span>
    <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;@charoff&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;charoff&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;@charoff&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:attribute&gt;</span>
    <span class="k">&lt;/xsl:if&gt;</span>
    <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;@valign&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;valign&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;@valign&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:attribute&gt;</span>
    <span class="k">&lt;/xsl:if&gt;</span>

    <span class="k">&lt;xsl:apply-templates</span> <span class="na">select=</span><span class="s">&quot;(entry|entrytbl)[1]&quot;</span> <span class="na">mode=</span><span class="s">&quot;ead&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;spans&quot;</span> <span class="na">select=</span><span class="s">&quot;$spans&quot;</span><span class="nt">/&gt;</span>
    <span class="k">&lt;/xsl:apply-templates&gt;</span>
  <span class="nt">&lt;/tr&gt;</span>

  <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;following-sibling::row&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;nextspans&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:apply-templates</span> <span class="na">select=</span><span class="s">&quot;(entry|entrytbl)[1]&quot;</span> <span class="na">mode=</span><span class="s">&quot;span&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;spans&quot;</span> <span class="na">select=</span><span class="s">&quot;$spans&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:apply-templates&gt;</span>
    <span class="k">&lt;/xsl:variable&gt;</span>

    <span class="k">&lt;xsl:apply-templates</span> <span class="na">select=</span><span class="s">&quot;following-sibling::row[1]&quot;</span> <span class="na">mode=</span><span class="s">&quot;ead&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;spans&quot;</span> <span class="na">select=</span><span class="s">&quot;$nextspans&quot;</span><span class="nt">/&gt;</span>
    <span class="k">&lt;/xsl:apply-templates&gt;</span>
  <span class="k">&lt;/xsl:if&gt;</span>
<span class="k">&lt;/xsl:template&gt;</span>

<span class="k">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;entry|entrytbl&quot;</span> <span class="na">name=</span><span class="s">&quot;entry&quot;</span> <span class="na">mode=</span><span class="s">&quot;ead&quot;</span><span class="nt">&gt;</span>
  <span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;col&quot;</span> <span class="na">select=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
  <span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;spans&quot;</span><span class="nt">/&gt;</span>

  <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;cellgi&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;ancestor::thead&quot;</span><span class="nt">&gt;</span>th<span class="k">&lt;/xsl:when&gt;</span>
      <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;ancestor::tfoot&quot;</span><span class="nt">&gt;</span>th<span class="k">&lt;/xsl:when&gt;</span>
      <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>td<span class="k">&lt;/xsl:otherwise&gt;</span>
    <span class="k">&lt;/xsl:choose&gt;</span>
  <span class="k">&lt;/xsl:variable&gt;</span>

  <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;empty.cell&quot;</span> <span class="na">select=</span><span class="s">&quot;count(node()) = 0&quot;</span><span class="nt">/&gt;</span>

  <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;named.colnum&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;entry.colnum&quot;</span><span class="nt">/&gt;</span>
  <span class="k">&lt;/xsl:variable&gt;</span>

  <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;entry.colnum&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;$named.colnum &amp;gt; 0&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$named.colnum&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:when&gt;</span>
      <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$col&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:otherwise&gt;</span>
    <span class="k">&lt;/xsl:choose&gt;</span>
  <span class="k">&lt;/xsl:variable&gt;</span>

  <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;entry.colspan&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;@spanname or @namest&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;calculate.colspan&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:when&gt;</span>
      <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>1<span class="k">&lt;/xsl:otherwise&gt;</span>
    <span class="k">&lt;/xsl:choose&gt;</span>
  <span class="k">&lt;/xsl:variable&gt;</span>

  <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;following.spans&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;calculate.following.spans&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;colspan&quot;</span> <span class="na">select=</span><span class="s">&quot;$entry.colspan&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;spans&quot;</span> <span class="na">select=</span><span class="s">&quot;$spans&quot;</span><span class="nt">/&gt;</span>
    <span class="k">&lt;/xsl:call-template&gt;</span>
  <span class="k">&lt;/xsl:variable&gt;</span>

  <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;rowsep&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
      </pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>If this is the last row, rowsep never applies. </p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;ancestor::entrytbl</span>
<span class="s">                      and not (ancestor-or-self::row[1]/following-sibling::row)&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:when&gt;</span>
      <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;not(ancestor-or-self::row[1]/following-sibling::row</span>
<span class="s">                          or ancestor-or-self::thead/following-sibling::tbody</span>
<span class="s">                          or ancestor-or-self::tbody/preceding-sibling::tfoot)&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:when&gt;</span>
      <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;inherited.table.attribute&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;entry&quot;</span> <span class="na">select=</span><span class="s">&quot;.&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;colnum&quot;</span> <span class="na">select=</span><span class="s">&quot;$entry.colnum&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;attribute&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;rowsep&#39;&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;/xsl:call-template&gt;</span>
      <span class="k">&lt;/xsl:otherwise&gt;</span>
    <span class="k">&lt;/xsl:choose&gt;</span>
  <span class="k">&lt;/xsl:variable&gt;</span>

  <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;colsep&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
      </pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>If this is the last column, colsep never applies. </p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;$following.spans = &#39;&#39;&quot;</span><span class="nt">&gt;</span>0<span class="k">&lt;/xsl:when&gt;</span>
      <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;inherited.table.attribute&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;entry&quot;</span> <span class="na">select=</span><span class="s">&quot;.&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;colnum&quot;</span> <span class="na">select=</span><span class="s">&quot;$entry.colnum&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;attribute&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;colsep&#39;&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;/xsl:call-template&gt;</span>
      <span class="k">&lt;/xsl:otherwise&gt;</span>
    <span class="k">&lt;/xsl:choose&gt;</span>
  <span class="k">&lt;/xsl:variable&gt;</span>

  <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;valign&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;inherited.table.attribute&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;entry&quot;</span> <span class="na">select=</span><span class="s">&quot;.&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;colnum&quot;</span> <span class="na">select=</span><span class="s">&quot;$entry.colnum&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;attribute&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;valign&#39;&quot;</span><span class="nt">/&gt;</span>
    <span class="k">&lt;/xsl:call-template&gt;</span>
  <span class="k">&lt;/xsl:variable&gt;</span>

  <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;align&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;inherited.table.attribute&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;entry&quot;</span> <span class="na">select=</span><span class="s">&quot;.&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;colnum&quot;</span> <span class="na">select=</span><span class="s">&quot;$entry.colnum&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;attribute&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;align&#39;&quot;</span><span class="nt">/&gt;</span>
    <span class="k">&lt;/xsl:call-template&gt;</span>
  <span class="k">&lt;/xsl:variable&gt;</span>

  <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;char&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;inherited.table.attribute&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;entry&quot;</span> <span class="na">select=</span><span class="s">&quot;.&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;colnum&quot;</span> <span class="na">select=</span><span class="s">&quot;$entry.colnum&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;attribute&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;char&#39;&quot;</span><span class="nt">/&gt;</span>
    <span class="k">&lt;/xsl:call-template&gt;</span>
  <span class="k">&lt;/xsl:variable&gt;</span>

  <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;charoff&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;inherited.table.attribute&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;entry&quot;</span> <span class="na">select=</span><span class="s">&quot;.&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;colnum&quot;</span> <span class="na">select=</span><span class="s">&quot;$entry.colnum&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;attribute&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;charoff&#39;&quot;</span><span class="nt">/&gt;</span>
    <span class="k">&lt;/xsl:call-template&gt;</span>
  <span class="k">&lt;/xsl:variable&gt;</span>

  <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;$spans != &#39;&#39; and not(starts-with($spans,&#39;0:&#39;))&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;entry&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;col&quot;</span> <span class="na">select=</span><span class="s">&quot;$col+1&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;spans&quot;</span> <span class="na">select=</span><span class="s">&quot;substring-after($spans,&#39;:&#39;)&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:call-template&gt;</span>
    <span class="k">&lt;/xsl:when&gt;</span>

    <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;$entry.colnum &amp;gt; $col&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;empty.table.cell&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;entry&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;col&quot;</span> <span class="na">select=</span><span class="s">&quot;$col+1&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;spans&quot;</span> <span class="na">select=</span><span class="s">&quot;substring-after($spans,&#39;:&#39;)&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:call-template&gt;</span>
    <span class="k">&lt;/xsl:when&gt;</span>

    <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;bgcolor&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;processing-instruction(&#39;dbhtml&#39;)&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;dbhtml-attribute&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;pis&quot;</span> <span class="na">select=</span><span class="s">&quot;processing-instruction(&#39;dbhtml&#39;)&quot;</span><span class="nt">/&gt;</span>
            <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;attribute&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;bgcolor&#39;&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:call-template&gt;</span>
        <span class="k">&lt;/xsl:if&gt;</span>
      <span class="k">&lt;/xsl:variable&gt;</span>

      <span class="k">&lt;xsl:element</span> <span class="na">name=</span><span class="s">&quot;{$cellgi}&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$bgcolor != &#39;&#39;&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;bgcolor&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$bgcolor&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:attribute&gt;</span>
        <span class="k">&lt;/xsl:if&gt;</span>

        <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$entry.propagates.style != 0 and @role&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;class&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;@role&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:attribute&gt;</span>
        <span class="k">&lt;/xsl:if&gt;</span>

        <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$show.revisionflag and @revisionflag&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;class&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;@revisionflag&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:attribute&gt;</span>
        <span class="k">&lt;/xsl:if&gt;</span>

        <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$table.borders.with.css != 0&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;style&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$colsep &amp;gt; 0&quot;</span><span class="nt">&gt;</span>
              <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;border&quot;</span><span class="nt">&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;side&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;right&#39;&quot;</span><span class="nt">/&gt;</span>
              <span class="k">&lt;/xsl:call-template&gt;</span>
            <span class="k">&lt;/xsl:if&gt;</span>
            <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$rowsep &amp;gt; 0&quot;</span><span class="nt">&gt;</span>
              <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;border&quot;</span><span class="nt">&gt;</span>
                <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;side&quot;</span> <span class="na">select=</span><span class="s">&quot;&#39;bottom&#39;&quot;</span><span class="nt">/&gt;</span>
              <span class="k">&lt;/xsl:call-template&gt;</span>
            <span class="k">&lt;/xsl:if&gt;</span>
          <span class="k">&lt;/xsl:attribute&gt;</span>
        <span class="k">&lt;/xsl:if&gt;</span>

        <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;@morerows &amp;gt; 0&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;rowspan&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;1+@morerows&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:attribute&gt;</span>
        <span class="k">&lt;/xsl:if&gt;</span>

        <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$entry.colspan &amp;gt; 1&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;colspan&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$entry.colspan&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:attribute&gt;</span>
        <span class="k">&lt;/xsl:if&gt;</span>

        <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$align != &#39;&#39;&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;align&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$align&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:attribute&gt;</span>
        <span class="k">&lt;/xsl:if&gt;</span>

        <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$valign != &#39;&#39;&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;valign&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$valign&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:attribute&gt;</span>
        <span class="k">&lt;/xsl:if&gt;</span>

        <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$char != &#39;&#39;&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;char&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$char&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:attribute&gt;</span>
        <span class="k">&lt;/xsl:if&gt;</span>

        <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$charoff != &#39;&#39;&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;charoff&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$charoff&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:attribute&gt;</span>
        <span class="k">&lt;/xsl:if&gt;</span>

        </pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>xsl:if test="not(preceding-sibling::*) and ancestor::row/@id">
          <xsl:call-template name="anchor">
            <xsl:with-param name="node" select="ancestor::row[1]"/>
          </xsl:call-template>
        </xsl:if </p>             </td>             <td class="code">               <div class="highlight"><pre>        </pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>xsl:call-template name="anchor"/ </p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;$empty.cell&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span><span class="ni">&amp;#160;</span><span class="k">&lt;/xsl:text&gt;</span>
          <span class="k">&lt;/xsl:when&gt;</span>
          <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;self::entrytbl&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;tgroup&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:when&gt;</span>
          <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:apply-templates</span> <span class="na">mode=</span><span class="s">&quot;ead&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:otherwise&gt;</span>
        <span class="k">&lt;/xsl:choose&gt;</span>
      <span class="k">&lt;/xsl:element&gt;</span>

      <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;following-sibling::entry|following-sibling::entrytbl&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:apply-templates</span> <span class="na">select=</span><span class="s">&quot;(following-sibling::entry</span>
<span class="s">                                       |following-sibling::entrytbl)[1]&quot;</span> <span class="na">mode=</span><span class="s">&quot;ead&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;col&quot;</span> <span class="na">select=</span><span class="s">&quot;$col+$entry.colspan&quot;</span><span class="nt">/&gt;</span>
            <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;spans&quot;</span> <span class="na">select=</span><span class="s">&quot;$following.spans&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:apply-templates&gt;</span>
        <span class="k">&lt;/xsl:when&gt;</span>
        <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;finaltd&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;spans&quot;</span> <span class="na">select=</span><span class="s">&quot;$following.spans&quot;</span><span class="nt">/&gt;</span>
            <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;col&quot;</span> <span class="na">select=</span><span class="s">&quot;$col+$entry.colspan&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:call-template&gt;</span>
        <span class="k">&lt;/xsl:otherwise&gt;</span>
      <span class="k">&lt;/xsl:choose&gt;</span>
    <span class="k">&lt;/xsl:otherwise&gt;</span>
  <span class="k">&lt;/xsl:choose&gt;</span>
<span class="k">&lt;/xsl:template&gt;</span>

<span class="k">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;entry|entrytbl&quot;</span> <span class="na">name=</span><span class="s">&quot;sentry&quot;</span> <span class="na">mode=</span><span class="s">&quot;span&quot;</span><span class="nt">&gt;</span>
  <span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;col&quot;</span> <span class="na">select=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
  <span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;spans&quot;</span><span class="nt">/&gt;</span>

  <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;entry.colnum&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;entry.colnum&quot;</span><span class="nt">/&gt;</span>
  <span class="k">&lt;/xsl:variable&gt;</span>

  <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;entry.colspan&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;@spanname or @namest&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;calculate.colspan&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:when&gt;</span>
      <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>1<span class="k">&lt;/xsl:otherwise&gt;</span>
    <span class="k">&lt;/xsl:choose&gt;</span>
  <span class="k">&lt;/xsl:variable&gt;</span>

  <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;following.spans&quot;</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;calculate.following.spans&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;colspan&quot;</span> <span class="na">select=</span><span class="s">&quot;$entry.colspan&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;spans&quot;</span> <span class="na">select=</span><span class="s">&quot;$spans&quot;</span><span class="nt">/&gt;</span>
    <span class="k">&lt;/xsl:call-template&gt;</span>
  <span class="k">&lt;/xsl:variable&gt;</span>

  <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;$spans != &#39;&#39; and not(starts-with($spans,&#39;0:&#39;))&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;substring-before($spans,&#39;:&#39;)-1&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span>:<span class="k">&lt;/xsl:text&gt;</span>
      <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;sentry&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;col&quot;</span> <span class="na">select=</span><span class="s">&quot;$col+1&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;spans&quot;</span> <span class="na">select=</span><span class="s">&quot;substring-after($spans,&#39;:&#39;)&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:call-template&gt;</span>
    <span class="k">&lt;/xsl:when&gt;</span>

    <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;$entry.colnum &amp;gt; $col&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span>0:<span class="k">&lt;/xsl:text&gt;</span>
      <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;sentry&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;col&quot;</span> <span class="na">select=</span><span class="s">&quot;$col+$entry.colspan&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;spans&quot;</span> <span class="na">select=</span><span class="s">&quot;$following.spans&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:call-template&gt;</span>
    <span class="k">&lt;/xsl:when&gt;</span>

    <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;copy-string&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;count&quot;</span> <span class="na">select=</span><span class="s">&quot;$entry.colspan&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;string&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;@morerows&quot;</span><span class="nt">&gt;</span>
              <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;@morerows&quot;</span><span class="nt">/&gt;</span>
            <span class="k">&lt;/xsl:when&gt;</span>
            <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>0<span class="k">&lt;/xsl:otherwise&gt;</span>
          <span class="k">&lt;/xsl:choose&gt;</span>
          <span class="k">&lt;xsl:text</span><span class="nt">&gt;</span>:<span class="k">&lt;/xsl:text&gt;</span>
        <span class="k">&lt;/xsl:with-param&gt;</span>
      <span class="k">&lt;/xsl:call-template&gt;</span>

      <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;following-sibling::entry|following-sibling::entrytbl&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:apply-templates</span> <span class="na">select=</span><span class="s">&quot;(following-sibling::entry</span>
<span class="s">                                        |following-sibling::entrytbl)[1]&quot;</span>
                               <span class="na">mode=</span><span class="s">&quot;span&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;col&quot;</span> <span class="na">select=</span><span class="s">&quot;$col+$entry.colspan&quot;</span><span class="nt">/&gt;</span>
            <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;spans&quot;</span> <span class="na">select=</span><span class="s">&quot;$following.spans&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:apply-templates&gt;</span>
        <span class="k">&lt;/xsl:when&gt;</span>
        <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;sfinaltd&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;spans&quot;</span> <span class="na">select=</span><span class="s">&quot;$following.spans&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:call-template&gt;</span>
        <span class="k">&lt;/xsl:otherwise&gt;</span>
      <span class="k">&lt;/xsl:choose&gt;</span>
    <span class="k">&lt;/xsl:otherwise&gt;</span>
  <span class="k">&lt;/xsl:choose&gt;</span>
<span class="k">&lt;/xsl:template&gt;</span>

<span class="k">&lt;xsl:template</span> <span class="na">name=</span><span class="s">&quot;generate.colgroup&quot;</span><span class="nt">&gt;</span>
  <span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;cols&quot;</span> <span class="na">select=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
  <span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;count&quot;</span> <span class="na">select=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
  <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;$count &amp;gt; $cols&quot;</span><span class="nt">&gt;</span><span class="k">&lt;/xsl:when&gt;</span>
    <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;generate.col&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;countcol&quot;</span> <span class="na">select=</span><span class="s">&quot;$count&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:call-template&gt;</span>
      <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;generate.colgroup&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;cols&quot;</span> <span class="na">select=</span><span class="s">&quot;$cols&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;count&quot;</span> <span class="na">select=</span><span class="s">&quot;$count+1&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:call-template&gt;</span>
    <span class="k">&lt;/xsl:otherwise&gt;</span>
  <span class="k">&lt;/xsl:choose&gt;</span>
<span class="k">&lt;/xsl:template&gt;</span>

<span class="k">&lt;xsl:template</span> <span class="na">name=</span><span class="s">&quot;generate.col&quot;</span><span class="nt">&gt;</span>
  <span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;countcol&quot;</span><span class="nt">&gt;</span>1<span class="k">&lt;/xsl:param&gt;</span>
  <span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;colspecs&quot;</span> <span class="na">select=</span><span class="s">&quot;./colspec&quot;</span><span class="nt">/&gt;</span>
  <span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;count&quot;</span><span class="nt">&gt;</span>1<span class="k">&lt;/xsl:param&gt;</span>
  <span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;colnum&quot;</span><span class="nt">&gt;</span>1<span class="k">&lt;/xsl:param&gt;</span>

  <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;$count&gt;count($colspecs)&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;col/&gt;</span>
    <span class="k">&lt;/xsl:when&gt;</span>
    <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;colspec&quot;</span> <span class="na">select=</span><span class="s">&quot;$colspecs[$count=position()]&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;colspec.colnum&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;$colspec/@colnum&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$colspec/@colnum&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:when&gt;</span>
          <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$colnum&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:otherwise&gt;</span>
        <span class="k">&lt;/xsl:choose&gt;</span>
      <span class="k">&lt;/xsl:variable&gt;</span>

      <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;$colspec.colnum=$countcol&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;col&gt;</span>
            <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$colspec/@colwidth</span>
<span class="s">                          and $use.extensions != 0</span>
<span class="s">                          and $tablecolumns.extension != 0&quot;</span><span class="nt">&gt;</span>
              <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;width&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;normalize-space($colspec/@colwidth) = &#39;*&#39;&quot;</span><span class="nt">&gt;</span>
                    <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;&#39;1*&#39;&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:when&gt;</span>
      <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
                    <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$colspec/@colwidth&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;/xsl:otherwise&gt;</span>
    <span class="k">&lt;/xsl:choose&gt;</span>
              <span class="k">&lt;/xsl:attribute&gt;</span>
            <span class="k">&lt;/xsl:if&gt;</span>

            <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
              <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;$colspec/@align&quot;</span><span class="nt">&gt;</span>
                <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;align&quot;</span><span class="nt">&gt;</span>
                  <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$colspec/@align&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;/xsl:attribute&gt;</span>
              <span class="k">&lt;/xsl:when&gt;</span>
              </pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>Suggested by Pavel ZAMPACH <a href="&#x6D;&#x61;&#105;&#x6C;&#116;&#111;:&#122;&#97;&#x6D;&#112;&#x61;&#x63;&#104;&#x40;&#110;&#x65;&#x6D;&#99;&#x62;&#x2E;&#99;&#x7A;">&#122;&#97;&#x6D;&#112;&#x61;&#x63;&#104;&#x40;&#110;&#x65;&#x6D;&#99;&#x62;&#x2E;&#99;&#x7A;</a> </p>             </td>             <td class="code">               <div class="highlight"><pre>              <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;$colspecs/ancestor::tgroup/@align&quot;</span><span class="nt">&gt;</span>
                <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;align&quot;</span><span class="nt">&gt;</span>
                  <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$colspecs/ancestor::tgroup/@align&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;/xsl:attribute&gt;</span>
              <span class="k">&lt;/xsl:when&gt;</span>
            <span class="k">&lt;/xsl:choose&gt;</span>

            <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$colspec/@char&quot;</span><span class="nt">&gt;</span>
              <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;char&quot;</span><span class="nt">&gt;</span>
                <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$colspec/@char&quot;</span><span class="nt">/&gt;</span>
              <span class="k">&lt;/xsl:attribute&gt;</span>
            <span class="k">&lt;/xsl:if&gt;</span>
            <span class="k">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;$colspec/@charoff&quot;</span><span class="nt">&gt;</span>
              <span class="k">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;charoff&quot;</span><span class="nt">&gt;</span>
                <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$colspec/@charoff&quot;</span><span class="nt">/&gt;</span>
              <span class="k">&lt;/xsl:attribute&gt;</span>
            <span class="k">&lt;/xsl:if&gt;</span>
          <span class="nt">&lt;/col&gt;</span>
        <span class="k">&lt;/xsl:when&gt;</span>
        <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;generate.col&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;countcol&quot;</span> <span class="na">select=</span><span class="s">&quot;$countcol&quot;</span><span class="nt">/&gt;</span>
            <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;colspecs&quot;</span> <span class="na">select=</span><span class="s">&quot;$colspecs&quot;</span><span class="nt">/&gt;</span>
            <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;count&quot;</span> <span class="na">select=</span><span class="s">&quot;$count+1&quot;</span><span class="nt">/&gt;</span>
            <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;colnum&quot;</span><span class="nt">&gt;</span>
              <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
                <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;$colspec/@colnum&quot;</span><span class="nt">&gt;</span>
                  <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$colspec/@colnum + 1&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;/xsl:when&gt;</span>
                <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
                  <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$colnum + 1&quot;</span><span class="nt">/&gt;</span>
                <span class="k">&lt;/xsl:otherwise&gt;</span>
              <span class="k">&lt;/xsl:choose&gt;</span>
            <span class="k">&lt;/xsl:with-param&gt;</span>
           <span class="k">&lt;/xsl:call-template&gt;</span>
        <span class="k">&lt;/xsl:otherwise&gt;</span>
      <span class="k">&lt;/xsl:choose&gt;</span>
    <span class="k">&lt;/xsl:otherwise&gt;</span>
  <span class="k">&lt;/xsl:choose&gt;</span>
<span class="k">&lt;/xsl:template&gt;</span>

<span class="k">&lt;xsl:template</span> <span class="na">name=</span><span class="s">&quot;colspec.colwidth&quot;</span><span class="nt">&gt;</span>
  </pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>when this macro is called, the current context must be an entry </p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;colname&quot;</span><span class="nt">&gt;</span><span class="k">&lt;/xsl:param&gt;</span>
  </pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>.. = row, ../.. = thead|tbody, ../../.. = tgroup </p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;colspecs&quot;</span> <span class="na">select=</span><span class="s">&quot;../../../../tgroup/colspec&quot;</span><span class="nt">/&gt;</span>
  <span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;count&quot;</span><span class="nt">&gt;</span>1<span class="k">&lt;/xsl:param&gt;</span>
  <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;$count&gt;count($colspecs)&quot;</span><span class="nt">&gt;</span><span class="k">&lt;/xsl:when&gt;</span>
    <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">&quot;colspec&quot;</span> <span class="na">select=</span><span class="s">&quot;$colspecs[$count=position()]&quot;</span><span class="nt">/&gt;</span>
      <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;$colspec/@colname=$colname&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$colspec/@colwidth&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;/xsl:when&gt;</span>
        <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;colspec.colwidth&quot;</span><span class="nt">&gt;</span>
            <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;colname&quot;</span> <span class="na">select=</span><span class="s">&quot;$colname&quot;</span><span class="nt">/&gt;</span>
            <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;colspecs&quot;</span> <span class="na">select=</span><span class="s">&quot;$colspecs&quot;</span><span class="nt">/&gt;</span>
            <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;count&quot;</span> <span class="na">select=</span><span class="s">&quot;$count+1&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;/xsl:call-template&gt;</span>
        <span class="k">&lt;/xsl:otherwise&gt;</span>
      <span class="k">&lt;/xsl:choose&gt;</span>
    <span class="k">&lt;/xsl:otherwise&gt;</span>
  <span class="k">&lt;/xsl:choose&gt;</span>
<span class="k">&lt;/xsl:template&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>====================================================================== </p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">&lt;xsl:template</span> <span class="na">name=</span><span class="s">&quot;tr.attributes&quot;</span><span class="nt">&gt;</span>
  <span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;row&quot;</span> <span class="na">select=</span><span class="s">&quot;.&quot;</span><span class="nt">/&gt;</span>
  <span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;rownum&quot;</span> <span class="na">select=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>

  </pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>by default, do nothing. But you might want to say:</p>

<p><xsl:if test="$rownum mod 2 = 0">
    <xsl:attribute name="class">oddrow</xsl:attribute>
  </xsl:if></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">&lt;/xsl:template&gt;</span>

<span class="k">&lt;xsl:template</span> <span class="na">name=</span><span class="s">&quot;copy-string&quot;</span><span class="nt">&gt;</span>
  </pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>returns 'count' copies of 'string' </p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;string&quot;</span><span class="nt">&gt;</span><span class="k">&lt;/xsl:param&gt;</span>
  <span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;count&quot;</span> <span class="na">select=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
  <span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;result&quot;</span><span class="nt">&gt;</span><span class="k">&lt;/xsl:param&gt;</span>

  <span class="k">&lt;xsl:choose</span><span class="nt">&gt;</span>
    <span class="k">&lt;xsl:when</span> <span class="na">test=</span><span class="s">&quot;$count&gt;0&quot;</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:call-template</span> <span class="na">name=</span><span class="s">&quot;copy-string&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;string&quot;</span> <span class="na">select=</span><span class="s">&quot;$string&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;count&quot;</span> <span class="na">select=</span><span class="s">&quot;$count - 1&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;xsl:with-param</span> <span class="na">name=</span><span class="s">&quot;result&quot;</span><span class="nt">&gt;</span>
          <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$result&quot;</span><span class="nt">/&gt;</span>
          <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$string&quot;</span><span class="nt">/&gt;</span>
        <span class="k">&lt;/xsl:with-param&gt;</span>
      <span class="k">&lt;/xsl:call-template&gt;</span>
    <span class="k">&lt;/xsl:when&gt;</span>
    <span class="k">&lt;xsl:otherwise</span><span class="nt">&gt;</span>
      <span class="k">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;$result&quot;</span><span class="nt">/&gt;</span>
    <span class="k">&lt;/xsl:otherwise&gt;</span>
  <span class="k">&lt;/xsl:choose&gt;</span>
<span class="k">&lt;/xsl:template&gt;</span>

<span class="k">&lt;xsl:template</span> <span class="na">name=</span><span class="s">&quot;dbhtml-attribute&quot;</span><span class="nt">&gt;</span>
 <span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;pis&quot;</span><span class="nt">/&gt;</span>
 <span class="k">&lt;xsl:param</span> <span class="na">name=</span><span class="s">&quot;attribute&quot;</span><span class="nt">/&gt;</span>
<span class="k">&lt;/xsl:template&gt;</span>

<span class="k">&lt;/xsl:stylesheet&gt;</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 